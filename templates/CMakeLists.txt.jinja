# This CMakeLists.txt is generated into the output directory (e.g., build_path in tests).
# It defines a library for the generated CBOR code and links against tinycbor.
# It assumes tinycbor is already available in the CMake project where this is included.

# Add the generated C file to a library
add_library({{ generated_library_name }} STATIC {{ generated_c_file_name }})

# Link against tinycbor.
# We assume tinycbor is already configured and available as a target.
# If tinycbor is fetched via FetchContent in a parent CMakeLists.txt,
# its targets will be available.
target_link_libraries({{ generated_library_name }} PRIVATE tinycbor)

# Add include directories for the generated header and tinycbor
target_include_directories({{ generated_library_name }} PUBLIC
    ${CMAKE_CURRENT_SOURCE_DIR} # For cbor_generated.h (which is in the same dir as this CMakeLists.txt)
    $<TARGET_PROPERTY:tinycbor,INTERFACE_INCLUDE_DIRECTORIES> # For tinycbor headers
)

# Set properties for the generated library
set_target_properties({{ generated_library_name }} PROPERTIES
    POSITION_INDEPENDENT_CODE ON
)
